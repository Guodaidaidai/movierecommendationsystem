
<!DOCTYPE HTML>
{% load static %}
<html>
    <head>
       <meta charset="utf-8">
       <title>院线比较</title>
        <link rel="stylesheet" type="text/css" href="{% static "css/bootstrap.css"%}">
        <!--<link rel="stylesheet" type="text/css" href="../css/component.css">-->
        <link rel="stylesheet" type="text/css" href='{% static "css/component.css"%}'>
        <link rel="stylesheet" type="text/css" href='{% static "css/subnav.css"%}'>
        <link rel="stylesheet" href='{% static "/css/single_film2.css"%}'>
        <link rel="stylesheet" type="text/css" href='{% static "css/font-awesome.min.css"%}'>
        <link rel="stylesheet" type="text/css" href='{% static "css/cinema_comparing.css"%}'>
  	    <script src='{% static "js/jquery.min.js"%}'></script>
		<script src='{% static "js/bootstrap.min.js"%}'></script>
        <script src='{% static "js/bootstrap.min.js"%}'></script>
        <script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.7.min.js"></script>
    </head>

<body>
	<div id="top"></div>
	<div id="navbg">
    <nav class="navigation_bar">
        <div class="logo_img"><a href="/comment/home/"><img src="{% static 'img/logo.png' %}"></a></div>
        <ul>
            <li><a href="/comment/home/">主页</a></li>
            <li><a href="/comment/recommend/">为你挑选</a></li>
            <li><a href="/comment/hot_film/">优秀电影</a></li>
            <li><a href="/comment/shown_film/">热映将映</a></li>
        </ul>
        <form class="nav_search" name="input" action="" method="post">
            {% csrf_token %}
            <input class="input_search" type="text" name="movie" placeholder="请输入电影名">
            <input class="input_button" type="submit" value="搜索" style="background-color:rgb(77,122,152);color:white">
        </form>
        <div class="navigationbar_right">
            <!--
  <span><a href="html/login.html">登录</a></span>
            <span><a href="html/regisiter.html">注册</a></span>
            -->
            <div class="portrait dropdown">
                <img src="{{user.last_name}}">
                <div class="dropdown-content">
                    <p><a href="/comment/personal_center/">个人中心</a></p>
                    <p><a href="/comment/login/">退出</a></p>
                </div>
            </div>
            <div class="nav_username">{{user.first_name}}</div>
        </div>
    </nav>
</div>

<div class="wrapper">
  <div class="style">
    <div class="symbol">
        <img src='{% static "img/quotation2.png"%}'>
      </div>
   <div class="k1">
    <div class="movie_name">{{movie.m_name}}</div>

      <div class="a1">
          <button onclick="collection('{{ movie.m_id }}','{{user.u_id}}')"><p>收藏</p></button>
       <div class="roundedOne">
      <input type="checkbox" value="None" id="roundedOne" name="check" checked />
      <label for="roundedOne"></label>
    </div>
      </div>
  </div>
     
      
      <!--
      <div class="movie_title">
       <div id="movie_name">名侦探柯南---唐红的恋歌
       </div>
       <div class="movie_link">
          <div class="address_link"><a href="#">观影链接</a></div>
          <div class="comment_link"><a href="#">更多影评</a></div>
       </div>
    </div>  -->
  </div>
    <div class="cont s--inactive">
    <!-- cont inner start -->
       <div class="cont__inner">
        <!-- el start -->
          <div class="el">
            <div class="el__overflow">
                <div class="el__inner">
                    <div class="el__bg"></div>
                    <div class="el__preview-cont">
                        <h2 class="el__heading">基本信息</h2>
                    </div>
                    <div class="el__content">
                        <div class="el__text">
                           <div class="c1">
                             <div class="movie_card">
                               <div class="movie_post">
                                <img src="{{movie.post_url}}">
                               </div>
                               <!-- <div class="name">{{movie.m_name}}
                                 </div>-->
                              </div>
                              <div class="movie_info">
                                <div class="info_content">
                                  <span class="p1">
                                  <span class="p2">名字：</span>
                                  <span class="attrs">{{movie.m_name}}</span>
                                  </span>
                                  <br>
                                  <!--<span class="p1">
                                  <span class="p2">编剧：</span>
                                  <span class="attrs">大仓崇裕</span>
                                  </span>
                                  <br>
                                  <span class="p1">
                                  <span class="actor">主演：</span>
                                  <span class="attrs">高山南、山崎和佳奈</span>
                                  </span>
                                  <br>-->
                                  <span class="p1">类型：{{movie.m_type}}</span>
                                  <br>
                                  <span class="p1">制片国家/地区：{{movie.m_country}}</span>
                                  <br>
                                  <!--<span class="p1">语言：日文/中文</span>
                                  <br>
                                  <span class="p1">片长：110分钟</span>
                                  <br>-->
                                  <span class="p1">时间：{{movie.m_year}}</span>
                                  <br>
                                </div>
                             </div>
                           </div>
                        </div>
                        <div class="el__close-btn"></div>
                    </div>
                </div>
            </div>
            <div class="el__index">
                <div class="el__index-back">D</div>
                <div class="el__index-front">
                    <div class="el__index-overlay" data-index="D">D</div>
                </div>
            </div>
          </div>
        <!-- el end -->
        <!-- el start -->
          <div class="el">
            <div class="el__overflow">
                <div class="el__inner">
                    <div class="el__bg"></div>
                    <div class="el__preview-cont">
                        <h2 class="el__heading">内容概述</h2>
                    </div>
                    <div class="el__content">
                        <div class="el__text">
                            <div class="outline">
                               薄雾笼罩的京都，一起攸关日本国家安全的大事件即将发生。一艘疑似装载爆炸物的可疑船只靠近舞鹤湾。通过对船上相关数据和零部件的勘察判明，该船很大可能来自海外。此消息一出，立刻引起全日本上下的恐慌。就在同一天，江户川柯南、毛利小五郎、毛利兰以及少年侦探团的各位一同观摩海上自卫队组织的对空作战演习，他们史无前例地登上了宙斯盾舰穗高号，与全国各地聚集来的孩子们一起，被装备了电子武装的高科技宙斯盾舰带来的巨大魄力所震撼。谁知演习中突发意外，原本虚拟的作战瞬间变成真枪实弹的杀戮。不久，海面上漂浮着的失去左臂的自卫队队员一等海尉笹浦洋介遗体被发现。种种不安与猜测在小兰和少年侦探们的心中蔓延。另一方面，海上自卫队迅速冷静地稳定事态，但始终不能探明敌人的真实身份和他的目标。就在此时，宙斯盾舰上发现了遇害队员的左臂，其配戴的手表指针停止在上午5:30。接二连三的异常事件，迫使大阪府警乘坐直升机赶来，与京都当地的同侪协作展开调查。在此期间，神秘的女性自卫队员藤井七海也登上了宙斯盾舰。
                            </div>
                        </div>
                        <div class="el__close-btn"></div>
                    </div>
                </div>
            </div>
            <div class="el__index">
                <div class="el__index-back">O</div>
                <div class="el__index-front">
                    <div class="el__index-overlay" data-index="O">O</div>
                </div>
            </div>
        </div>

        <!-- el end -->
        <!-- el start -->
        <div class="el">
            <div class="el__overflow">
                <div class="el__inner">
                    <div class="el__bg"></div>
                    <div class="el__preview-cont">
                        <h2 class="el__heading">院线对比</h2>
                    </div>
                    <div class="el__content">
                        <div class="el__text">
                            <nav class="menu">
	<ul id="price_info">

	</ul>
<!--........................zhang.......................-->
<script >

    function updateCinema(cinemas,cur_position){
        $("#price_info").empty();
        for(var i=cur_position*3;i<cinemas.length&&i<cur_position*3+5;i++){
        var li=$("<li></li>");
        var d;
        if (dises.length!=0){
            d=dises[i]
        }else{
            d=""
        }
        if(i==cur_position*3){
            var a = $("<a></a>").attr("class", "auto_a").text("<<").attr("href", "#").attr("id", "上一批");

        }else if(i<=cur_position*3+3) {
            var a = $("<a></a>").attr("class", "auto_a").text(cinemas[i]["fields"]["name"] + " " + d).attr("href", "#").attr("id", cinemas[i]["pk"]);

        }else{
            var a = $("<a></a>").attr("class", "auto_a").text(">>").attr("href", "#").attr("id", "下一批");

        }
        li.append(a);
        $("#price_info").append(li);
    }
    }


    var m_id={{ m_id }};//m_id信息一定存在
    var c_id;
    var date;
    var cinemas ={{cinema_dis_list|safe}};//cinema信息一定有
    var dises={{dis|safe}};
    var cur_cinema_position=0;
    var last_cinema_position=(cinemas.length)/3;


    updateCinema(cinemas,cur_cinema_position);





</script>
<script>
    $("#price_info").on("click","a",function(){
        var el=$(this);
        if(el.attr("id")=="上一批"){
            if(cur_cinema_position==0){
                return;

            }else{
                cur_cinema_position--;
                updateCinema(cinemas,cur_cinema_position)
            }
            return;
        }

        if(el.attr("id")=="下一批"){
            if(cur_cinema_position==last_cinema_position){
                return;
            }else{
                cur_cinema_position++;
                updateCinema(cinemas,cur_cinema_position)
            }

            return ;
        }
    });

    $("#price_info").on("mouseover","a",function(){
        var first=1;
        var el=$(this);
        if(el.attr("id")=="上一批"){
            return;
        }
        if(el.attr("id")=="下一批"){
            return;
        }

        if(el.attr("class")=="auto_a"){//点击的是影院
            first=0;//日期默认为第一天
            c_id=el.attr("id");

        }else {//点击的是时间
            date = el.text();
        }

        $.get("/zhang/ajax/price_in_cinema/",{"m_id":m_id,"c_id":c_id,"date":date,"first":first},function(data){

            dataObj=JSON.parse(data);
            mes=dataObj.message;//用来判断是否有排片信息

            dates=dataObj.dates;//获取到这家电影院全部的dates信息.




            if(first==0){//点击影院的响应事件，更新date值

                var ul=$("<ul></ul>");
                if(dates.length==0){//该影院不放映该电影
                    var li=$("<li></li>");
                    var div=$("<div></div>").text("这家电影院没有放映该电影噢，试试其他影院吧~").attr("class","no_price_info");
                    li.append(div)
                    ul.append(li)

                }else {
                    for (var i = 0; i < dates.length; i++) {
                        var li = $("<li></li>");
                        var a = $("<a></a>").attr("href","#").attr("title","").text(dates[i]);
                        li.append(a);
                        ul.append(li)

                    }
                }
                el.after(ul)

            }else{//点击日期的响应时间，更新票价信息.
                var ul=$('<ul></ul>').attr("class","left_side");
                var z1_div=$('<div></div>').attr("class","z1");


                if(mes!=undefined){//该日期没有电影
                    //alert(mes)
                    var film_div=$('<div></div>').attr("class","film").text(mes);
                    z1_div.append(film_div);
                }else{
                    prices=JSON.parse(dataObj.prices);

                    for (var i=0;i<prices.length;i++) {
                       // alert(i);
                        var film_div = $('<div></div>').attr("class", "film");
                        var time1_div = $('<div></div>').attr("class", "new_film_price").text(prices[i]["fields"]["start_time"]);
                        var time2_div = $('<div></div>').attr("class", "new_film_price").text(prices[i]["fields"]["end_time"]);
                        var halln_div = $('<div></div>').attr("class", "long_film_price").text(prices[i]["fields"]["hall_name"]);
                        var hallt_div = $('<div></div>').attr("class", "long2_film_price").text(prices[i]["fields"]["hall_type"]);
                        var price_div=$('<div></div>').attr("class","new_film_price").text(prices[i]["fields"]["price"]+"元");
                        var w_name_div=$('<div></div>').attr("class","new_film_price").text(prices[i]["fields"]["w_name"]);
                        film_div.append(time1_div);
                        film_div.append(time2_div);
                        film_div.append(halln_div);
                        film_div.append(hallt_div);
                        film_div.append(w_name_div);
                        film_div.append(price_div);

                        z1_div.append(film_div);
                    }

                }
                ul.append(z1_div);
                el.after(ul);

            }




        })

    });


</script>
<!--........................zhang.......................-->
</nav>
                        </div>
                        <div class="el__close-btn"></div>
                    </div>
                </div>
            </div>
            <div class="el__index">
                <div class="el__index-back">G</div>
                <div class="el__index-front">
                    <div class="el__index-overlay" data-index="G">G</div>
                </div>
            </div>
        </div>
        <!-- el end -->
       </div>
    <!-- cont inner end -->
    </div>   
    
</div>       
        <script>
        var $cont = document.querySelector('.cont');
var $elsArr = [].slice.call(document.querySelectorAll('.el'));
var $closeBtnsArr = [].slice.call(document.querySelectorAll('.el__close-btn'));

setTimeout(function() {
    $cont.classList.remove('s--inactive');
}, 200);

$elsArr.forEach(function($el) {
    $el.addEventListener('click', function() {
        if (this.classList.contains('s--active')) return;
        $cont.classList.add('s--el-active');
        this.classList.add('s--active');
    });
});

$closeBtnsArr.forEach(function($btn) {
    $btn.addEventListener('click', function(e) {
        e.stopPropagation();
        $cont.classList.remove('s--el-active');
        document.querySelector('.el.s--active').classList.remove('s--active');
    });
});
    </script>
	<!--悬浮主导航栏-->
<script type="text/javascript">
$(document).ready(function () {
    var topH=$("#top").height();//获取头部高度，top指导航栏上面的部分
    var navbg=$("#navbg");//获取导航栏对象
    $(window).scroll(function () {
        if($(window).scrollTop()>topH){//对比滚动的距离与导航栏上面部分的高度大小来动态添加css样式
            navbg.addClass("scrollNav")//对导航栏添加样式
        }else{
            navbg.removeClass("scrollNav")//去掉导航栏添加的样式
        }
    });
});
</script>

    
</body>
</html>        
        
        
        
        
        
        
        

